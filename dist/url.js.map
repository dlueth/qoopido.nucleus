{"version":3,"sources":["url.js"],"names":["global","document","definition","abstractUuid","Descriptor","iterate","resolveCurrent","resolver","createElement","href","slice","getLinkProperty","uuid","property","properties","storage","link","setLinkProperty","value","Parameter","self","this","objectDefineProperties","update","Url","url","call","parameter","toString","valueOf","Object","defineProperties","regexMatchLeadingSlash","regexMatchParameter","regexMatchSpaces","regexMatchOpeningBrackets","regexMatchClosingBrackets","regexMatchLocal","RegExp","regexMatchDefaults","http:","https:","ftp:","prototype","get","name","set","serialize","remove","context","tokens","search","split","join","exec","decodeURIComponent","result","encodeURIComponent","replace","local","test","origin","protocol","host","username","password","hostname","port","pathname","hash","extends","provide"],"mappings":"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","file":"url.js","sourcesContent":["/**\n * @use /demand/abstract/uuid\n */\n\n(function(global, document) {\n\t'use strict';\n\n\tfunction definition(abstractUuid, Descriptor, iterate) {\n\t\tvar objectDefineProperties    = Object.defineProperties,\n\t\t\tstorage                   = {},\n\t\t\tregexMatchLeadingSlash    = /^\\//,\n\t\t\tregexMatchParameter       = /[?&]?([^=]+)=([^&]*)/g,\n\t\t\tregexMatchSpaces          = /%20/g,\n\t\t\tregexMatchOpeningBrackets = /%5B/g,\n\t\t\tregexMatchClosingBrackets = /%5D/g,\n\t\t\tregexMatchLocal           = new RegExp('^' + resolveCurrent(), 'i'),\n\t\t\tregexMatchDefaults        = {\n\t\t\t\t'http:':  /:80$/,\n\t\t\t\t'https:': /:443$/,\n\t\t\t\t'ftp:':   /:21$/\n\t\t\t};\n\n\t\tfunction resolveCurrent() {\n\t\t\tvar resolver = document.createElement('a');\n\n\t\t\tresolver.href = '/';\n\n\t\t\treturn resolver.href.slice(0, -1);\n\t\t}\n\n\t\tfunction getLinkProperty(uuid, property) {\n\t\t\tvar properties;\n\n\t\t\tif(properties = storage[uuid]) {\n\t\t\t\treturn properties.link[property];\n\t\t\t}\n\t\t}\n\n\t\tfunction setLinkProperty(uuid, property, value) {\n\t\t\tvar properties;\n\n\t\t\tif(properties = storage[uuid]) {\n\t\t\t\tproperties.link[property] = value;\n\t\t\t}\n\t\t}\n\n\t\tfunction Parameter(uuid) {\n\t\t\tvar self = this;\n\n\t\t\tobjectDefineProperties(self, { uuid: new Descriptor(uuid) });\n\n\t\t\tParameter.update(self);\n\t\t}\n\n\t\tParameter.prototype = {\n\t\t\t/* only for reference\n\t\t\tuuid: null\n\t\t\t*/\n\t\t\tget: function(name) {\n\t\t\t\treturn storage[this.uuid].parameter[name];\n\t\t\t},\n\t\t\tset: function(name, value) {\n\t\t\t\tstorage[this.uuid].parameter[name] = value;\n\n\t\t\t\tParameter.serialize(this);\n\t\t\t},\n\t\t\tremove: function(name) {\n\t\t\t\tdelete storage[this.uuid].parameter[name];\n\n\t\t\t\tParameter.serialize(this);\n\t\t\t}\n\t\t};\n\n\t\tParameter.update = function(context) {\n\t\t\tvar properties = storage[context.uuid],\n\t\t\t\tparameter  = properties.parameter,\n\t\t\t\tsearch     = properties.link.search.split('+').join(' '),\n\t\t\t\ttokens;\n\n\t\t\titerate(parameter, function(property) {\n\t\t\t\tdelete parameter[property];\n\t\t\t});\n\n\t\t\twhile(tokens = regexMatchParameter.exec(search)) {\n\t\t\t\tparameter[decodeURIComponent(tokens[1])] = decodeURIComponent(tokens[2]);\n\t\t\t}\n\t\t};\n\n\t\tParameter.serialize = function(context) {\n\t\t\tvar properties = storage[context.uuid],\n\t\t\t\tparameter  = properties.parameter,\n\t\t\t\tresult     = '';\n\n\t\t\titerate(parameter, function(property, value) {\n\t\t\t\tresult += (!result ? '?' : '&') + encodeURIComponent(property) + '=' + encodeURIComponent(value);\n\t\t\t});\n\n\t\t\tproperties.link.search = result\n\t\t\t\t.replace(regexMatchSpaces, '+')\n\t\t\t\t.replace(regexMatchOpeningBrackets, '[')\n\t\t\t\t.replace(regexMatchClosingBrackets, ']');\n\t\t};\n\n\t\tfunction Url(url) {\n\t\t\tvar self = abstractUuid.call(this),\n\t\t\t\tlink = document.createElement('a');\n\n\t\t\tlink.href = url;\n\n\t\t\tstorage[self.uuid] = {\n\t\t\t\tlink:      link,\n\t\t\t\tparameter: {}\n\t\t\t};\n\n\t\t\tobjectDefineProperties(self, {\n\t\t\t\ttoString:  new Descriptor(function() { return link.toString(); }),\n\t\t\t\tvalueOf:   new Descriptor(function() { return link.valueOf(); }),\n\t\t\t\tparameter: new Descriptor(new Parameter(self.uuid))\n\t\t\t});\n\t\t\t\n\t\t\treturn self;\n\t\t}\n\n\t\tUrl.prototype = {\n\t\t\tget local() {\n\t\t\t\tvar value;\n\n\t\t\t\tif(value = getLinkProperty(this.uuid, 'href')) {\n\t\t\t\t\treturn regexMatchLocal.test(value);\n\t\t\t\t}\n\t\t\t},\n\t\t\tget href() {\n\t\t\t\treturn getLinkProperty(this.uuid, 'href');\n\t\t\t},\n\t\t\tset href(value) {\n\t\t\t\tsetLinkProperty(this.uuid, 'href', value);\n\t\t\t},\n\t\t\tget origin() {\n\t\t\t\tvar self = this;\n\n\t\t\t\treturn getLinkProperty(self.uuid, 'origin') || self.protocol + '//' + self.host;\n\t\t\t},\n\t\t\tget protocol() {\n\t\t\t\treturn getLinkProperty(this.uuid, 'protocol');\n\t\t\t},\n\t\t\tset protocol(value) {\n\t\t\t\tsetLinkProperty(this.uuid, 'protocol', value);\n\t\t\t},\n\t\t\tget username() {\n\t\t\t\treturn getLinkProperty(this.uuid, 'username');\n\t\t\t},\n\t\t\tset username(value) {\n\t\t\t\tsetLinkProperty(this.uuid, 'username', value);\n\t\t\t},\n\t\t\tget password() {\n\t\t\t\treturn getLinkProperty(this.uuid, 'password');\n\t\t\t},\n\t\t\tset password(value) {\n\t\t\t\tsetLinkProperty(this.uuid, 'password', value);\n\t\t\t},\n\t\t\tget host() {\n\t\t\t\tvar value, protocol;\n\n\t\t\t\tif(value = getLinkProperty(this.uuid, 'host')) {\n\t\t\t\t\tprotocol = getLinkProperty(this.uuid, 'protocol');\n\n\t\t\t\t\treturn regexMatchDefaults[protocol] ? value.replace(regexMatchDefaults[protocol], '') : value;\n\t\t\t\t}\n\t\t\t},\n\t\t\tset host(value) {\n\t\t\t\tsetLinkProperty(this.uuid, 'host', value);\n\t\t\t},\n\t\t\tget hostname() {\n\t\t\t\treturn getLinkProperty(this.uuid, 'hostname');\n\t\t\t},\n\t\t\tset hostname(value) {\n\t\t\t\tsetLinkProperty(this.uuid, 'hostname', value);\n\t\t\t},\n\t\t\tget port() {\n\t\t\t\treturn getLinkProperty(this.uuid, 'port');\n\t\t\t},\n\t\t\tset port(value) {\n\t\t\t\tsetLinkProperty(this.uuid, 'port', value);\n\t\t\t},\n\t\t\tget pathname() {\n\t\t\t\tvar value;\n\n\t\t\t\tif(value = getLinkProperty(this.uuid, 'pathname')) {\n\t\t\t\t\treturn regexMatchLeadingSlash.test(value) ? value : '/' + value;\n\t\t\t\t}\n\t\t\t},\n\t\t\tset pathname(value) {\n\t\t\t\tsetLinkProperty(this.uuid, 'pathname', value);\n\t\t\t},\n\t\t\tget search() {\n\t\t\t\treturn getLinkProperty(this.uuid, 'search');\n\t\t\t},\n\t\t\tset search(value) {\n\t\t\t\tsetLinkProperty(this.uuid, 'search', value);\n\n\t\t\t\tParameter.update.call(this);\n\t\t\t},\n\t\t\tget hash() {\n\t\t\t\treturn getLinkProperty(this.uuid, 'hash');\n\t\t\t},\n\t\t\tset hash(value) {\n\t\t\t\tsetLinkProperty(this.uuid, 'hash', value);\n\t\t\t}\n\t\t};\n\n\t\treturn Url.extends(abstractUuid);\n\t}\n\n\tprovide([ '/demand/abstract/uuid', '/demand/descriptor', '/demand/function/iterate' ], definition);\n}(this, document));"]}