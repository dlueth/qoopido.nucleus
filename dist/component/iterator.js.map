{"version":3,"sources":["component/iterator.js"],"names":["provide","Weakmap","Emitter","functionMerge","storage","getDataProperty","context","property","properties","get","data","ComponentIterator","settings","self","call","this","set","index","setData","prototype","length","getStorageProperty","item","initial","seek","parseInt","first","last","previous","loop","next","extends"],"mappings":";CAOC,WACA,aAiHAA,QAAQ,CAAE,kBAAmB,aAAc,sBA/G3C,SAAoBC,EAASC,EAASC,GACrC,IAAIC,EAAU,IAAIH,EAUlB,SAASI,EAAgBC,EAASC,GACjC,IAAIC,EAEJ,IAAIA,EAAaJ,EAAQK,IAAIH,KAAaE,EAAWE,KACpD,OAAOF,EAAWE,KAAKH,GAIzB,SAASI,EAAkBD,EAAME,GAChC,IAAIC,EAAOX,EAAQY,KAAKC,MAUxB,OARAX,EAAQY,IAAIH,EAAM,CACjBD,SAAUT,EAAc,GAAIQ,EAAkBC,SAAUA,GACxDK,MAAU,KACVP,KAAU,OAGXA,GAAQG,EAAKK,QAAQR,GAEdG,EA8ER,OA3EAF,EAAkBQ,UAAY,CAG3BC,aACC,OAAOf,EAAgBU,KAAM,WAAa,GAG3CE,YACC,OAtCJ,SAA4BX,EAASC,GACpC,IAAIC,EAEJ,GAAGA,EAAaJ,EAAQK,IAAIH,GAC3B,OAAOE,EAAmB,MAkCjBa,CAAmBN,OAG3BO,WACC,OAAOjB,EAAgBU,KAAMA,KAAKE,QAGpCC,QAAS,SAASR,GACjB,IACCF,EAAYI,EAab,MAXmB,iBAATF,GAAqBA,EAAKU,SAEnCR,GADAJ,EAAaJ,EAAQK,IAJXM,OAKcH,SAExBJ,EAAWE,KAAOA,EAEM,OAArBE,EAASW,SATFR,KAUJS,KAAKZ,EAASW,UAVVR,MAgBZS,KAAM,SAASP,GACd,IACCT,EAAaJ,EAAQK,IADLM,MASjB,OANAE,EAAQQ,SAASR,EAAO,OAEXT,EAAWS,OAA2C,oBAA3BT,EAAWE,KAAKO,KACvDT,EAAWS,MAAQA,GANHF,MAWlBW,MAAO,WACN,OAAOX,KAAKS,KAAK,IAElBG,KAAM,WAGL,OAFWZ,KAECS,KAFDT,KAEWK,OAAS,IAEhCQ,SAAU,WACT,IAECX,EADAL,EAAaR,EAAQK,IADLM,MACeH,SAMhC,OAHAK,GAA2B,IAAlBL,EAASiB,MAJDd,KAIwBE,MAAQ,GAJhCF,KAI0CK,OAJ1CL,KAIwDE,MAAQ,EACjFA,GAA2B,IAAlBL,EAASiB,MAAiBZ,EAAQ,EAL1BF,KAKoCK,OAASH,EAAQA,EALrDF,KAOLS,KAAKP,IAElBa,KAAM,WACL,IAECb,EAID,OAFAA,GAA2B,IAHbb,EAAQK,IADLM,MACeH,SAGdiB,MAJDd,KAIwBE,MAAQ,GAJhCF,KAI0CK,OAJ1CL,KAIwDE,MAAQ,EAJhEF,KAMLS,KAAKP,KAIpBN,EAAkBC,SAAW,CAAEiB,MAAM,EAAMN,QAAS,GAE7CZ,EAAkBoB,QAAQ7B,MA/GnC","file":"iterator.js","sourcesContent":["/**\n * @use /demand/weakmap\n *\n * @require ../emitter\n * @require ../function/merge\n */\n\n(function() {\n\t'use strict';\n\n\tfunction definition(Weakmap, Emitter, functionMerge) {\n\t\tvar storage = new Weakmap();\n\n\t\tfunction getStorageProperty(context, property) {\n\t\t\tvar properties;\n\n\t\t\tif(properties = storage.get(context)) {\n\t\t\t\treturn properties[property];\n\t\t\t}\n\t\t}\n\n\t\tfunction getDataProperty(context, property) {\n\t\t\tvar properties;\n\n\t\t\tif((properties = storage.get(context)) && properties.data) {\n\t\t\t\treturn properties.data[property];\n\t\t\t}\n\t\t}\n\n\t\tfunction ComponentIterator(data, settings) {\n\t\t\tvar self = Emitter.call(this);\n\n\t\t\tstorage.set(self, {\n\t\t\t\tsettings: functionMerge({}, ComponentIterator.settings, settings),\n\t\t\t\tindex:    null,\n\t\t\t\tdata:     null\n\t\t\t});\n\n\t\t\tdata && self.setData(data);\n\n\t\t\treturn self;\n\t\t}\n\n\t\tComponentIterator.prototype = {\n\t\t\t// properties\n\t\t\t\t// length\n\t\t\t\t\tget length() {\n\t\t\t\t\t\treturn getDataProperty(this, 'length') || 0;\n\t\t\t\t\t},\n\t\t\t\t// index\n\t\t\t\t\tget index() {\n\t\t\t\t\t\treturn getStorageProperty(this, 'index');\n\t\t\t\t\t},\n\t\t\t\t// item\n\t\t\t\t\tget item() {\n\t\t\t\t\t\treturn getDataProperty(this, this.index);\n\t\t\t\t\t},\n\t\t\t// methods\n\t\t\t\tsetData: function(data) {\n\t\t\t\t\tvar self = this,\n\t\t\t\t\t\tproperties, settings;\n\n\t\t\t\t\tif(typeof data === 'object' && data.length) {\n\t\t\t\t\t\tproperties = storage.get(self);\n\t\t\t\t\t\tsettings   = properties.settings;\n\n\t\t\t\t\t\tproperties.data = data;\n\n\t\t\t\t\t\tif(settings.initial !== null) {\n\t\t\t\t\t\t\tself.seek(settings.initial);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\treturn self;\n\t\t\t\t},\n\t\t\t\tseek: function(index) {\n\t\t\t\t\tvar self       = this,\n\t\t\t\t\t\tproperties = storage.get(self);\n\n\t\t\t\t\tindex = parseInt(index, 10);\n\n\t\t\t\t\tif(index !== properties.index && typeof properties.data[index] !== 'undefined') {\n\t\t\t\t\t\tproperties.index = index;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn self;\n\t\t\t\t},\n\t\t\t\tfirst: function() {\n\t\t\t\t\treturn this.seek(0);\n\t\t\t\t},\n\t\t\t\tlast: function() {\n\t\t\t\t\tvar self = this;\n\n\t\t\t\t\treturn self.seek(self.length - 1);\n\t\t\t\t},\n\t\t\t\tprevious: function() {\n\t\t\t\t\tvar self       = this,\n\t\t\t\t\t\tsettings   = storage.get(self).settings,\n\t\t\t\t\t\tindex;\n\n\t\t\t\t\tindex = (settings.loop === true) ? (self.index - 1) % self.length : self.index - 1;\n\t\t\t\t\tindex = (settings.loop === true && index < 0) ? self.length + index : index;\n\n\t\t\t\t\treturn self.seek(index);\n\t\t\t\t},\n\t\t\t\tnext: function() {\n\t\t\t\t\tvar self       = this,\n\t\t\t\t\t\tsettings   = storage.get(self).settings,\n\t\t\t\t\t\tindex;\n\n\t\t\t\t\tindex = (settings.loop === true) ? (self.index + 1) % self.length : self.index + 1;\n\n\t\t\t\t\treturn self.seek(index);\n\t\t\t\t}\n\t\t};\n\n\t\tComponentIterator.settings = { loop: true, initial: 0 };\n\n\t\treturn ComponentIterator.extends(Emitter);\n\t}\n\n\tprovide([ '/demand/weakmap', '../emitter', '../function/merge' ], definition);\n}());\n"]}