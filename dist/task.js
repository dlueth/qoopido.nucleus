!function(g){"use strict";provide(["/demand/abstract/uuid","/demand/pledge","/demand/validator/isInstanceOf","/demand/function/defer","./support/method"],function(n,s,t,a,e){var r,d="ArrayBuffer"in g?d:null,i=e("Worker"),o=e("URL"),u=e("Blob"),l=i&&o&&u,c={idle:[],busy:{}},p=[],f=0;function m(){var r,e;!p.length||l&&!c.idle.length||(r=p.shift(),l?(e=c.idle.shift(),(c.busy[r.uuid]=e).addEventListener("message",r.onMessage),e.addEventListener("error",r.onError),e.postMessage({load:r.load.toString(),parameter:r.parameter},d&&t(r.parameter,d)?[r.parameter]:null)):a(function(){try{r.deferred.resolve(r.load.apply(null,r.parameter))}catch(e){r.deferred.reject()}m()}))}function h(e){var r=c.busy[e.uuid];delete c.busy[e.uuid],r.removeEventListener("message",e.onMessage),r.removeEventListener("error",e.onError),c.idle.push(r),m()}function v(e,r){var t=n.call(this),a=s.defer();return t.deferred=a,t.load=e,t.parameter=r||[],p.push(t),m(),a.pledge}if(v.prototype={onMessage:function(e){"result"===e.data.type&&(this.deferred.resolve(e.data.result),h(this))},onError:function(){this.deferred.reject(),h(this)}},l)try{for(r=o.createObjectURL(new u(['function d(a){return a.replace(c,"").trim()}function e(a){return a}var a=this,b=/functions.*?(([^)]*))/,c=//*.**//;a.addEventListener("message",function(b){a.postMessage({type:"result",result:a.process(b.data.load).apply(null,b.data.parameter)})},!1),a.process=function(a){var c=a.match(b)[1].split(",").map(d).filter(e);return c.push(a.substring(a.indexOf("{")+1,a.lastIndexOf("}"))),Function.apply(null,c)};'],{type:"application/javascript"}));f<4;f++)c.idle[f]=new i(r)}catch(e){l=!1}return v.extends(n)})}(this);
//# sourceMappingURL=task.js.map
