!function(e,t){"use strict";provide(["/demand/weakmap","/demand/pledge","/demand/validator/isObject","/demand/function/iterate","../url","../function/merge"],function(n,r,o,a,s,i){var c="XDomainRequest"in e&&e.XDomainRequest||t,u=/%20/g,l=/%5B/g,d=/%5D/g,p=new n;function h(e){var n,s,i=p.get(this),h=i.settings,f=i.url,m=i.data,T=f.local?new t:new c,g=r.defer(),w=function(){this.readyState<4&&this.abort()}.bind(T),R=h.timeout;return m&&"GET"===e&&(a(m,f.parameter.set),m=null),h.cache||f.parameter.set("nucleus",+new Date),m&&(s="",a(m,function(e,t){s+=(s?"&":"")+encodeURIComponent(e)+"="+encodeURIComponent(t)}),m=s.replace(u,"+").replace(l,"[").replace(d,"]")),o(h.xhrOptions)&&a(h.xhrOptions,function(e,t){T[e]=t}),T.ontimeout=T.onerror=T.onabort=function(){g.reject(T)},T.onprogress=T.onreadystatechange=function(){clearTimeout(n),n=setTimeout(w,R)},T.onload=function(){n=clearTimeout(n),"status"in T&&200!==T.status?g.reject(T):g.resolve(T.responseText,T)},T.open(e,f.href,!0),T.setRequestHeader&&(T.setRequestHeader("Accept",h.accept),m&&"GET"!==e&&T.setRequestHeader("Content-Type",h.contentType),o(h.header)&&a(h.header,function(e,t){T.setRequestHeader(e,t)})),T.send(m),n=setTimeout(w,R),g.pledge}function f(e,t,n){return p.set(this,{settings:i({},f.settings,n),url:new s(e),data:t}),this}return f.prototype={get:function(){return h.call(this,"GET")},post:function(){return h.call(this,"POST")},put:function(){return h.call(this,"PUT")},patch:function(){return h.call(this,"PATCH")},delete:function(){return h.call(this,"DELETE")},head:function(){return h.call(this,"HEAD")}},f.settings={accept:"*/*",timeout:8e3,async:!0,cache:!1,username:null,password:null,contentType:"application/x-www-form-urlencoded; charset=UTF-8",header:{},xhrOptions:{}},f})}(this,XMLHttpRequest);
//# sourceMappingURL=xhr.js.map
